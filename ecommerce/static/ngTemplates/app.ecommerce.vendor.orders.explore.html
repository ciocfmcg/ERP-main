<div ng-controller="businessManagement.ecommerce.orders.explore" style="padding-top:20px;">
  <div class="col-md-12">
    <div class="col-md-3" style="border-right:solid 2px #eeeeee;min-height:82vh;position:relative;">

      <div class="row text-center">
        <h3>{{order.created | date : dd-MMM-yyyy}}</h3>
        <h4>Status : {{order.status}}</h4>
        <h4>Amount : <i class="fa fa-inr"></i> {{order.totalAmount}}</h4>
      </div>
      <div class="row" style="margin-top:20px;font-size:18px;padding:5px 15px">
        <span><strong>Shoping : </strong>{{order.modeOfShopping}} <br></span>
        <span><strong>Payment Mode : </strong>{{order.paymentMode}} <br></span>
        <span><strong>Paid Amount : </strong>{{order.paidAmount}} <br></span>
        <span><strong>Payment Status : </strong>{{order.paymentStatus}} <br></span>
        <span><strong>Payment RefId : </strong>{{order.paymentRefId}} <br></span>
        <span><strong>Payment Channel : </strong>{{order.paymentChannel}} <br></span>
        <span ng-if="order.promoCode!=null"><strong>promoCode : </strong>{{order.promoCode}} <br></span>
        <!-- <span><strong>LandMark : </strong>{{order.landMark}} <br></span> -->
      </div>
      <div class="row" style="margin-top:20px;">
        <div class="col-md-2">
          <i class="fa fa-map-marker fa-3x pull-right" style="color:#8faec2;"></i>
        </div>
        <div class="col-md-10" style="font-size:18px">
          <span><strong>LandMark :</strong> {{order.landMark}} <br></span>
          <span>{{order.street}}</span> <br>
          <span>{{order.city}}</span> <br>
          <span>{{order.state}}</span> <br>
          <span>{{order.pincode}}</span> <br>
          <span>{{order.country}}</span> <br>
        </div>
      </div>
      <div class="row" style="margin-top:10px;">
        <div class="col-md-2">
          <i class="fa fa-mobile-phone fa-2x pull-right" style="color:#8faec2;"></i>
        </div>
        <div class="col-md-10" style="font-size:18px">
          <span>{{order.mobileNo}}</span> <br><br>
        </div>
      </div>

    </div>
    <div class="col-md-9">
      <div class="row">
        <div class="text-center" ng-if="order.approved">
          <h3>Approved <i class='fa fa-check' style="color:green"></i></h3>
        </div>
        <div class="text-center" ng-if="order.approved!=null && !order.approved">
          <h3>Rejected <i class='fa fa-times' style="color:red"></i></h3>
        </div>

        <div class="btn-group pull-right" ng-if="order.approved==null">
          <button type="button" class="btn btn-primary" mwl-confirm title="Approve" message="Are you sure?" confirm-text="Yes <i class='fa fa-check'></i>" cancel-text="No" on-confirm="orderApproved(order.pk,true)" confirm-button-type="default" cancel-button-type="default">Approve </button>
          <button type="button" class="btn btn-danger" mwl-confirm title="Reject" message="Are you sure?" confirm-text="Yes <i class='fa fa-check'></i>" cancel-text="No" on-confirm="orderApproved(order.pk,false)" confirm-button-type="default" cancel-button-type="default">Reject </button>
        </div>

        <!-- <div class="btn btn-primary pull-right" ng-if="!order.approved" mwl-confirm title="Approve" message="Are you sure?" confirm-text="Yes <i class='fa fa-check'></i>" cancel-text="No" on-confirm="orderApproved(order.pk)" confirm-button-type="default" cancel-button-type="default">
          Approve This Order
        </div> -->
      </div>
      <div class="row" style="margin:20px 5px">
        <div class="" ng-repeat="pData in order.orderQtyMap" style="margin-bottom:10px">
          <div class="container-fluid card" style="padding:20px; border-left:4px solid #0c9a9e;position:relative;">
            <div class="fa fa-trash-o pull-right fa-2x" style="cursor:pointer;color:red" mwl-confirm title="Cancel Item" message="Are you sure?" confirm-text="Yes <i class='fa fa-check'></i>" cancel-text="No" on-confirm="orderItemCancel($index)" confirm-button-type="default"
              cancel-button-type="default" ng-if="order.status!='failed' && pData.status=='created' || pData.status=='packed'">
            </div>
            <div class="btn btn-default btn-sm pull-right" ng-if="pData.courierName==null||pData.courierAWBNo==null||pData.notes==null && order.status!='failed'" ng-click="openManifest($index)">
              Generate Manifest
            </div>
            <div class="btn-group pull-right" ng-if="order.status!='failed' && pData.courierName!=null && pData.courierAWBNo!=null && pData.notes!=null">
              <button type="button" class="btn btn-primary" ng-click="openManifest($index)">Edit Manifest </button>
              <a href="/api/ecommerce/downloadManifest/?qPk={{pData.pk}}" target="_blank">
               <button type="button" class="btn btn-default">Download Manifest <i class="fa fa-download"></i></button> </a>

            </div>

            <div class="row">
              <h3> {{pData.productName}} </h3>
            </div>
            <div class="row">
              <div class="col-md-2">
                <span style="font-size:15px;">Price : <i class="fa fa-inr"></i> {{pData.productPrice}}</span>
              </div>
              <div class="col-md-2">
                <span style="font-size:15px;">Quantity : {{pData.qty}}</span>
              </div>
              <div class="col-md-3">
                <span style="font-size:15px;">Total Price : <i class="fa fa-inr"></i> {{pData.totalAmount}}</span>
              </div>
              <div class="col-md-2">
                <span style="font-size:15px;">Discount : <i class="fa fa-inr"></i> {{pData.discountAmount}} </span>
              </div>
              <div class="col-md-3">
                <span style="font-size:15px;">Paid Amount : <i class="fa fa-inr"></i> {{pData.totalAmount - pData.discountAmount}} </span>
              </div>
            </div>
            <hr>
            <div class="row">
              <div class="col-md-12">
                <div class="row">
                  <!-- <div class="col-md-12"> -->
                  <div class="col-md-5" style="font-size:19px">
                    <strong>Status : {{pData.status}}</strong>
                  </div>
                  <div class="col-md-7 text-right" style="font-size:19px" ng-if="order.status!='failed' && pData.status != 'cancelled' && pData.status!='returned'">
                    <span class="text-muted ">Change Status To </span> &nbsp;
                    <div class="btn btn-warning pull-right">
                      <span mwl-confirm title="Change Status" message="Are you sure?" confirm-text="Yes <i class='fa fa-check'></i>" cancel-text="No" on-confirm="changeStatus($index,'packed')" confirm-button-type="default" cancel-button-type="default" ng-if="pData.status=='created'">Packed</span>
                      <span mwl-confirm title="Change Status" message="Are you sure?" confirm-text="Yes <i class='fa fa-check'></i>" cancel-text="No" on-confirm="changeStatus($index,'shipped')" confirm-button-type="default" cancel-button-type="default" ng-if="pData.status=='packed'">Shipped</span>
                      <span mwl-confirm title="Change Status" message="Are you sure?" confirm-text="Yes <i class='fa fa-check'></i>" cancel-text="No" on-confirm="changeStatus($index,'inTransit')" confirm-button-type="default" cancel-button-type="default" ng-if="pData.status=='shipped'">InTransit</span>
                      <span mwl-confirm title="Change Status" message="Are you sure?" confirm-text="Yes <i class='fa fa-check'></i>" cancel-text="No" on-confirm="changeStatus($index,'reachedNearestHub')" confirm-button-type="default" cancel-button-type="default" ng-if="pData.status=='inTransit'">ReachedNearestHub</span>
                      <span mwl-confirm title="Change Status" message="Are you sure?" confirm-text="Yes <i class='fa fa-check'></i>" cancel-text="No" on-confirm="changeStatus($index,'outForDelivery')" confirm-button-type="default" cancel-button-type="default" ng-if="pData.status=='reachedNearestHub'">OutForDelivery</span>
                      <span mwl-confirm title="Change Status" message="Are you sure?" confirm-text="Yes <i class='fa fa-check'></i>" cancel-text="No" on-confirm="changeStatus($index,'delivered')" confirm-button-type="default" cancel-button-type="default" ng-if="pData.status=='outForDelivery'">Delivered</span>
                      <span mwl-confirm title="Change Status" message="Are you sure?" confirm-text="Yes <i class='fa fa-check'></i>" cancel-text="No" on-confirm="changeStatus($index,'returnToOrigin')" confirm-button-type="default" cancel-button-type="default" ng-if="pData.status=='delivered'">ReturnToOrigin</span>
                      <span mwl-confirm title="Change Status" message="Are you sure?" confirm-text="Yes <i class='fa fa-check'></i>" cancel-text="No" on-confirm="changeStatus($index,'returned')" confirm-button-type="default" cancel-button-type="default" ng-if="pData.status=='returnToOrigin'">Returned</span>
                    </div>
                    <!-- <div class="btn btn-warning btn-sm pull-right" ng-if="pData.status = 'cancelled'">
                        <span ng-click="" ng-if="pData.status=='delivered'">ReturnToOrigin</span>
                        <span ng-click="" ng-if="pData.status=='returned'">Returned</span>
                      </div> -->

                  </div>
                  <!-- </div> -->
                  <!-- <span><strong><h3>Status : {{pData.status}}</h3></strong>
                    <div class="btn btn-warning btn-sm pull-right">
                      Change Status
                    </div>
                  </span> -->
                </div>
                <span>Refund Amount : {{pData.refundAmount}}</span><br>
                <span>Refund Status : {{pData.refundStatus}}</span><br>
                <span>Cancellable : {{pData.cancellable}}</span><br>
              </div>
            </div>
            <div class="row" style="margin-top:15px">
              <div class="btn btn-default btn-lg" ng-click="expanded= !expanded">
                Logs &nbsp;<i class="fa fa-chevron-{{ !expanded ? 'down':'up'}}"></i>
              </div>
              <div class="row" ng-if="expanded" style="margin-top:15px;margin-left:15px">
                <div class="col-md-6">
                  <!-- <div class="input-group" >
                  <label>Log</label>
                  <textarea class="form-control" rows="4" cols="80" ng-model="eventScheduler.details"></textarea>
                  <span class="input-group-btn">
                  <div class="btn btn-success pull-right" ng-click="">Submit</div>
                </span>
              </div> -->
                  <div class="form-group">
                    <textarea class="form-control" rows="3" cols="80" ng-model="pData.logText" placeholder="Write Log Here..."></textarea>
                  </div>
                  <div class="btn btn-success pull-right" ng-click="saveLog($index,pData.logText)">Submit</div>
                </div>
                <div class="col-md-12">
                  <h4>Logs History</h4>

                  <table class="table table-striped">
                    <tbody>
                      <tr ng-repeat="log in pData.trackingLog">
                        <td style="width:20%">{{log.time | date : 'dd-MMM-yyyy : hh:mm a'}}</td>
                        <td style="width:80%">{{log.logTxt}}</td>
                      </tr>
                    </tbody>

                  </table>

                  <!-- <ul>
                    <li ng-repeat="log in pData.trackingLog" style="font-size:15px">
                      <div class="col-md-9">
                        {{log.logTxt}}
                      </div>
                      <div class="col-md-3 text-right">
                        {{log.time | date : 'dd-MMM-yyyy : hh:mm a'}}
                      </div>
                      </li>
                  </ul> -->
                </div>
              </div>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</div>
